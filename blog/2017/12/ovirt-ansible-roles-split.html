<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
oVirt roles Ansible Galaxy integration &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='omachace' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>
<link href='/blog/feed.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<!-- Open Graph (FB / G+) -->
<meta content='article' property='og:type'>
<meta content='oVirt roles Ansible Galaxy integration' property='og:title'>
<meta content='In 4.2 release we have splitted our oVirt Ansible roles into separate RPM packages and also separate git repositories, so it is possible for user to install specific role either from Ansible Galaxy or as RPM package.' property='og:description'>
<meta content='http://ovirt.org/blog/2017/12/ovirt-ansible-roles-split.html' property='og:url'>
<meta content='2017-12-08T15:00:00Z' property='article:published_time'>
<meta content='omachace' property='article:author:username'>
<meta content='Ansible' property='article:tag'>
<link href='/blog/tag/ansible.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<meta content='Automation' property='article:tag'>
<link href='/blog/tag/automation.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<meta content='Configuration management' property='article:tag'>
<link href='/blog/tag/configuration management.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<meta content='Galaxy' property='article:tag'>
<link href='/blog/tag/galaxy.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<meta content='Roles' property='article:tag'>
<link href='/blog/tag/roles.xml' rel='alternate' title='Atom feed' type='application/atom+xml'>
<!-- Twitter card -->
<meta content='summary' name='twitter:card'>
<meta content='oVirt roles Ansible Galaxy integration' name='twitter:title'>
<meta content='In 4.2 release we have splitted our oVirt Ansible roles into separate RPM packages and also separate git repositories, so it is possible for user to install specific role either from Ansible Galaxy or as RPM package.' name='twitter:description'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
<link href="/stylesheets/application.css?1560777611" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1560777612" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'></section>
<div id='access'>
<nav id="mainNav" class="navbar-fixed-top affix-top navForMobileHack" style="font-family: 'Open Sans', sans-serif; display: flex; justify-content: center;">
      <a href="/"><img id="logo" style="float: left; margin-right: 70px; height: 40px; padding: 0; margin-top: 12px;" alt="oVirt" src="/images/logo.svg"></a>
      <div>
          <div class="navbar-header page-scroll" style="min-width: 170px">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu_id0980fddf">
                  <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
              </button>
          </div>

          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="menu_id0980fddf">

              <ul class="nav navbar-nav">
                  <li class="hidden active">
                      <a href="#page-top"></a>
                  </li>
<li role='menuitem'>
  <a href='/'>Home</a>
</li>

<li role='menuitem'>
  <a href='/download/'>Download</a>
</li>

<li role='menuitem'>
  <a href='/documentation/'>Documentation</a>
</li>

<li role='menuitem'>
  <a href='/develop/'>Developers</a>
</li>

<li role='menuitem'>
  <a href='/community/'>Community</a>
</li>

<li role='menuitem'>
  <a href='//lists.ovirt.org/archives/'>Forum</a>
</li>

<li role='menuitem'>
  <a href='/blog/'>Blog</a>
</li>

              </ul>
          </div>
          <!-- /.navbar-collapse -->
      </div>
      <!-- /.container-fluid -->
  </nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<ul class='breadcrumb'>
<li class='active'>Blog</li>
<li class='active'>2017</li>
<li class='active'>12</li>
</ul>

<section class='container content' id='content'>
<!--[if lt IE 7]>
<p class="chromeframe">You are using an outdated browser.
<a href="http://browsehappy.com/">Upgrade your browser today</a> or
<a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<section class='blog-post-page row'>
<div class='col-md-10 col-md-offset-1'>
<article class='post hentry'>
<header class='post-header'>
<h2 class='post-title entry-title'>
oVirt roles Ansible Galaxy integration
</h2>
<header class='post-meta'>
<div class='blogger_avatar'>
<img src='/blogger_avatars/omachace.png'>
</div>
<span class='byline'>
by
<span class='author vcard'>
<a href="/blog/author/omachace/">omachace</a>
</span>
&ndash;
</span>
<time class='published' datetime='2017-12-08T15:00:00Z'>
Friday  8 December 2017
</time>
</header>
</header>
<section class='post-content entry-content'>
<p>In 4.2 release we have splitted our oVirt Ansible roles into separate RPM packages and also separate git repositories, so it is possible for user to install specific role either from Ansible Galaxy or as RPM package.</p>

<p></p>

<h2 id="the-reason">The reason</h2>
<p>The reason to split the roles into separate packages and git repositories was mainly the usage from the AWX/Ansible Tower. Since Ansible Galaxy is only integrated with github you need to store your Ansible role in single git repostiory in order to have separate Ansible role in Galaxy. Previously we used one single repository where we have stored all the roles, but because of that manual configuration was required to make those roles usable in AWX/Ansible Tower. So as you can see on image below we now have many roles in Ansible Galaxy under oVirt user:</p>

<p><img alt="oVirt roles in Ansible Galaxy" width="1920" height="1080" src="/images/galaxy_roles.png?1560777613" /></p>

<h2 id="how-to-install-the-roles">How to install the roles</h2>
<p>There are still two ways how to install the roles: either using Ansible Galaxy or using RPM package available from oVirt repositories.</p>

<h3 id="ansible-galaxy">Ansible Galaxy</h3>
<p>You are now able to install just a single role and not necessarily all of them at once like in previous versions
For example to install just oVirt cluster upgrade role, you have to run following command:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>ansible-galaxy install oVirt.cluster-upgrade&#x000A;</code></pre></div>
<p>Note that we still support the posibility to download and install all roles at once,
you can do it by executing following command:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>ansible-galaxy install oVirt.ovirt-ansible-roles&#x000A;</code></pre></div>
<h3 id="from-ovirt-repository">From oVirt repository</h3>
<p>Also using RPM you are now able to install just a single role and not necessarily all of them at once like in previous versions.
For example to install just oVirt cluster upgrade role, you have to run following command:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>yum install ovirt-ansible-cluster-upgrade&#x000A;</code></pre></div>
<p>Note that we haven't obsoleted the <code>ovirt-ansible-roles</code> package, it still exists and you can install all available oVirt roles using:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>yum install ovirt-ansible-roles&#x000A;</code></pre></div>
<p>The only difference is that this package now requires all the separate packages, so the packages itself
only provides documentation and examples.</p>

<h2 id="compatibility-changes">Compatibility changes</h2>
<p>Unfortunatelly the split has its price.</p>

<h3 id="the-names">The names</h3>

<h4 id="roles-from-ansible-galaxy">Roles from Ansible Galaxy</h4>
<p>Unfortunatelly split has also broken the names of the roles in Ansible Galaxy.
So before user could used the following names:</p>

<ul>
  <li>ovirt-cluster-upgrade</li>
  <li>ovirt-image-template</li>
  <li>ovirt-infra</li>
  <li>ovirt-manageiq</li>
  <li>ovirt-vm-infra</li>
</ul>

<p>But since the naming in Ansible Galaxy is done as {owner}.{role-name}, we had to rename
the roles to:</p>

<ul>
  <li>oVirt.cluster-upgrade</li>
  <li>oVirt.image-template</li>
  <li>oVirt.infra</li>
  <li>oVirt.manageiq</li>
  <li>oVirt.vm-infra</li>
</ul>

<p>Notice that we have changed the first dash by the dot and renamed <code>ovirt</code> to <code>oVirt</code>.</p>

<h4 id="roles-from-rpm">Roles from RPM</h4>
<p>For the users who installed roles from RPM. The names with dash will still work,
as we are creating a symlink to new names. But please be aware that we will remove
this legacy name one day in the future.</p>

<h3 id="removal-of-component-roles">Removal of component roles</h3>
<p>Previously the ovirt-ansible-roles package shipped the following component roles:</p>

<ul>
  <li>ovirt-aaa-jdbc</li>
  <li>ovirt-affinity-groups</li>
  <li>ovirt-clusters</li>
  <li>ovirt-datacenter-cleanup</li>
  <li>ovirt-datacenters</li>
  <li>ovirt-external-providers</li>
  <li>ovirt-hosts</li>
  <li>ovirt-mac-pools</li>
  <li>ovirt-networks</li>
  <li>ovirt-permissions</li>
  <li>ovirt-storages</li>
</ul>

<p>Those roles are not provided as separately installable roles, but those are just internal
roles of <code>ovirt-infra</code> and <code>ovirt-vm-infra</code> roles. But the good thing is that user didn't
loose the ability execute the specific component role, we have tagged all the tasks in the
component roles with specific tags, so if you want to execute just single <code>oVirt-infra</code>
role inside <code>oVirt.infra</code> role, you can execute playbook with <code>oVirt.infra</code> role with tag
<code>hosts</code> and only <code>ovirt-hosts</code> role will be executed, for example:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>ansible-playbook <span class="nt">--tags</span> hosts ovirt_infra.yml&#x000A;</code></pre></div>
<p>To list all possible tags please execute following command, on playbook, where you execute
<code>oVirt.infra</code> role:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>ansible-playbook <span class="nt">--list-tags</span> ovirt_infra.yml &#x000A;&#x000A;playbook: ovirt_infra.yml&#x000A;&#x000A;  play <span class="c">#1 (localhost): oVirt infra	TAGS: []</span>&#x000A;      TASK TAGS: <span class="o">[</span>always, clusters, datacenters, external_providers, host_networks, hosts, logical_networks, mac_pools, networks, ovirt-aaa-jdbc, permissions, reinstall, storage_connections, storages, user_groups, users]&#x000A;</code></pre></div>
<p>Please note that any of those role can be created as separate role in future, if there will be need for it.</p>

</section>
<footer class='post-meta'>
<div class='tags'>
Tags:
<ul class='taglist'></ul>
<li><a href="../../tag/ansible.html">Ansible</a></li>
<li><a href="../../tag/automation.html">Automation</a></li>
<li><a href="../../tag/configuration-management.html">Configuration management</a></li>
<li><a href="../../tag/galaxy.html">Galaxy</a></li>
<li><a href="../../tag/roles.html">Roles</a></li>
</div>
</footer>
</article>

<section id='blog-comments'></section>
</div>
</section>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="../../../site/privacy-policy.html">Privacy policy</a></li>
<li><a target="_blank" href="../../../community/about.html">About</a></li>
<li><a target="_blank" href="../../../site/general-disclaimer.html">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2019 oVirt
<div class='edit-this-page'>
<a target="_blank" href="https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/source/blog/2017-12-08-ovirt-ansible-roles-split.html.md&amp;template="><i class="icon fa fa-github"></i>Report an issue with this page</a>
</div>
<div class='edit-this-page'>
<a target="_blank" href="https://github.com/oVirt/ovirt-site/edit/master/source/blog/2017-12-08-ovirt-ansible-roles-split.html.md"><i class="icon fa fa-github"></i>Edit this page</a>
</div>
<div class='last-modified'>
Page last modified
Fri 8 Dec 2017 13:43 UTC
</div>
        <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://stats.phx.ovirt.org/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', 1]);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
        g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
        </script>
<noscript><p><img src="https://stats.phx.ovirt.org/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
</footer>


<script src="/javascripts/application.js?1560777657" type="text/javascript"></script>

</body>
</html>
