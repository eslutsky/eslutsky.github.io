<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
ExternalTasks &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
<link href="/stylesheets/application.css?1560777611" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1560777612" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'></section>
<div id='access'>
<nav id="mainNav" class="navbar-fixed-top affix-top navForMobileHack" style="font-family: 'Open Sans', sans-serif; display: flex; justify-content: center;">
      <a href="/"><img id="logo" style="float: left; margin-right: 70px; height: 40px; padding: 0; margin-top: 12px;" alt="oVirt" src="/images/logo.svg"></a>
      <div>
          <div class="navbar-header page-scroll" style="min-width: 170px">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu_id0980fddf">
                  <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
              </button>
          </div>

          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="menu_id0980fddf">

              <ul class="nav navbar-nav">
                  <li class="hidden active">
                      <a href="#page-top"></a>
                  </li>
<li role='menuitem'>
  <a href='/'>Home</a>
</li>

<li role='menuitem'>
  <a href='/download/'>Download</a>
</li>

<li role='menuitem'>
  <a href='/documentation/'>Documentation</a>
</li>

<li role='menuitem'>
  <a href='/develop/'>Developers</a>
</li>

<li role='menuitem'>
  <a href='/community/'>Community</a>
</li>

<li role='menuitem'>
  <a href='//lists.ovirt.org/archives/'>Forum</a>
</li>

<li role='menuitem'>
  <a href='/blog/'>Blog</a>
</li>

              </ul>
          </div>
          <!-- /.navbar-collapse -->
      </div>
      <!-- /.container-fluid -->
  </nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<ul class='breadcrumb'>
<li><a href="/develop/">Develop</a></li>
<li><a href="/develop/release-management/">Release-management</a></li>
<li><a href="/develop/release-management/features/">Features</a></li>
<li><a href="/develop/release-management/features/infra/">Infra</a></li>
</ul>

<section class='container content' id='content'>
<div class='alert alert-warning'>
Feature pages are design documents that developers have created while collaborating on oVirt.
<br>
<br>
Most of them are
<strong>
outdated
</strong>
, but provide historical design context.
<br>
<br>
They are
<strong>
not
</strong>
user documentation and should not be treated as such.
<br>
<br>
<a href='/documentation/'>Documentation is available here.</a>
</div>
<h1 id="external-tasks">External Tasks</h1>

<h2 id="adding-external-tasks-support">Adding External Tasks Support</h2>

<h3 id="summary">Summary</h3>

<p>Enable plug-in to inject tasks to the engine application using the REST API, change their statuses and track them from the UI.
A task may have other nesting sub-tasks under it.</p>

<h3 id="owner">Owner</h3>

<ul>
  <li>Name: James Rankin (MyUser)</li>
</ul>

<!-- -->

<ul>
  <li>Email: jrankin@redhat.com</li>
</ul>

<h3 id="current-status">Current status</h3>

<ul>
  <li>Last updated date: Feb 12, 2013</li>
</ul>

<h3 id="use-case">Use Case</h3>

<p>The main use case is for third party vendors, to integrate with oVirt. A vendor may have a set of external tasks that he may inject to the system in any flow. Multiple Vendors may integrate with the system at any given time.</p>

<h3 id="detailed-description">Detailed Description</h3>

<p>Plug-ins using the REST API should be enable to inject and track external tasks to oVirt and see those tasks displayed in the oVirt UI.
Tasks may be nested
Tasks may run concurrently
Sub-Tasks of the same Task may run concurrently
Tasks/Sub-Tasks should support the following statuses:</p>

<div class="highlight"><pre class="highlight plaintext"><code>  Waiting&#x000A;  Started (only for the task)&#x000A;  Running&#x000A;  Completed &#x000A;  Failed&#x000A;</code></pre></div>
<p>Solution should support setting percentage for the Task Started state
<strong>Task Flow</strong></p>

<div class="highlight"><pre class="highlight plaintext"><code>    Waiting -&gt; Started (x %) |&#x000A;                             -&gt; Completed&#x000A;                             |&#x000A;                             -&gt; Failed &#x000A;</code></pre></div>
<p><strong>Sub Task Flow</strong></p>

<div class="highlight"><pre class="highlight plaintext"><code>   Waiting -&gt; Running        |&#x000A;                             -&gt; Completed&#x000A;                             |&#x000A;                             -&gt; Failed&#x000A;</code></pre></div>
<p><strong>\1</strong></p>

<div class="highlight"><pre class="highlight plaintext"><code>  Adding a new task&#x000A;  Adding a nested sub-task to an existing task&#x000A;  Removing a task&#x000A;  Updating a task/sub-task status&#x000A;</code></pre></div>
<p>As in the Task Monitor that serves internal oVirt commands, Task should be displayed for a configurable time after competion and then vanished from the UI.</p>

<h3 id="benefit-to-ovirt">Benefit to oVirt</h3>

<p>The benefit of External Tasks injection is the ability to track tasks that are performed outside of oVirt or hybrid tasks when some of the sub-tasks are done by oVirt and some are external
this feature will enable all users to track the advance of a task that is not completely executed under oVirt.</p>

<p>Sample use-cases:
A user would like to clone a VM and cranks up our Rapid Cloning wizard. They fill in all the information and have selected a VM that is currently running. Upon clicking Ok, the information is sent to the server which starts performing a set of actions including the following</p>

<div class="highlight"><pre class="highlight plaintext"><code>    a. Shutdown the VM (oVirt REST)&#x000A;    b. Coalesce the disk (oVirt REST)&#x000A;    c. Clone the disk (External)&#x000A;    d. Update metadata in domain associated with new disk (External)&#x000A;    e. Create new VM based on data from original VM (oVirt REST)&#x000A;    f. Attach cloned disk to VM (oVirt REST)&#x000A;</code></pre></div>
<p>Each of these items would be a subtask of the overall Cloning task. At the beginning of this process, we would create the Cloning task through REST in oVirt. We could potentially include all the subtasks in the initial creation or add them as needed.
 As the tasks are performed, we would make REST calls to update the started/ finished status as well as the percentage complete if that's supported.</p>

<h3 id="dependencies--related-features">Dependencies / Related Features</h3>

<p>See also <a href="/develop/release-management/features/ux/uiplugins/">UI-Plugins</a></p>

<h3 id="documentation--external-references">Documentation / External references</h3>

<p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=872719">RFE</a></p>

<h2 id="testing">Testing</h2>

<h3 id="test-1">Test 1</h3>

<div class="highlight"><pre class="highlight plaintext"><code>  Create an external job which is marked as auto-cleared&#x000A;   Add external steps and sub steps to the job&#x000A;   Update on completed tasks and sub tasks &#x000A;   Check that job completes successfully and is cleared after the configured timeout &#x000A;</code></pre></div>
<h3 id="test-2">Test 2</h3>

<div class="highlight"><pre class="highlight plaintext"><code>   Repeat test 1 with auto-cleared = false&#x000A;   After job completes verify that it is not cleared after the configured timeout from DB&#x000A;   Clear the job manually&#x000A;</code></pre></div>
<h3 id="test-3">Test 3</h3>

<div class="highlight"><pre class="highlight plaintext"><code>   Repeat test 1 with a job that includes a mix of internal and external steps , &#x000A;   Make sure that for internal steps the job/step parent id should be set in the URI parameters&#x000A;   &#x000A;</code></pre></div>
<h3 id="test-4">Test 4</h3>

<div class="highlight"><pre class="highlight plaintext"><code>   Repeat test 2 with a job that includes a mix of internal and external steps ,&#x000A;   Make sure that for internal steps the job/step parent id should be set in the URI parameters&#x000A;</code></pre></div>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="../../../../site/privacy-policy.html">Privacy policy</a></li>
<li><a target="_blank" href="../../../../community/about.html">About</a></li>
<li><a target="_blank" href="../../../../site/general-disclaimer.html">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2019 oVirt
<div class='edit-this-page'>
<a target="_blank" href="https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/source/develop/release-management/features/infra/externaltasks.html.md&amp;template="><i class="icon fa fa-github"></i>Report an issue with this page</a>
</div>
<div class='edit-this-page'>
<a target="_blank" href="https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/infra/externaltasks.html.md"><i class="icon fa fa-github"></i>Edit this page</a>
</div>
<div class='last-modified'>
Page last modified
Wed 12 Jul 2017 17:57 UTC
</div>
        <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://stats.phx.ovirt.org/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', 1]);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
        g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
        </script>
<noscript><p><img src="https://stats.phx.ovirt.org/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
</footer>


<script src="/javascripts/application.js?1560777657" type="text/javascript"></script>

</body>
</html>
